<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8" />
  <title>Zakazivanje slikanja</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, select, button { margin: 5px; padding: 5px; }
    .termin { border: 1px solid #ccc; padding: 10px; margin: 5px 0; }
  </style>
</head>
<body>
  <h1>Zakazivanje slikanja</h1>

  <div>
    <input type="date" id="datum" />
    <select id="vreme">
      <option value="">Izaberi vreme</option>
      <script>
        for (let h = 9; h <= 19; h++) {
          ["00", "30"].forEach(m => {
            const v = (h < 10 ? "0" : "") + h + ":" + m;
            document.write(`<option value="${v}">${v}</option>`);
          });
        }
      </script>
    </select>
    <input type="text" id="sifra" placeholder="Šifra stana" />
    <input type="text" id="agent" placeholder="Agent" />
    <input type="text" id="adresa" placeholder="Adresa" />
    <input type="text" id="telefon" placeholder="Telefon" />
    <label><input type="checkbox" id="slikano" /> Slikano</label>
    <button onclick="sacuvaj()">Sačuvaj</button>
  </div>

  <h2>Sačuvani termini:</h2>
  <div id="listaTermina">Učitavanje...</div>

  <script>
    const URL = "https://script.google.com/macros/s/AKfycbzdksNljB7DrO1qXsTMlybrEdbvatJg10vA8nFkrKD46bwBPpamANqpU0S9Go1qJARj9A/exec";

    function sacuvaj() {
      const podaci = {
        datum: document.getElementById('datum').value,
        vreme: document.getElementById('vreme').value,
        sifra: document.getElementById('sifra').value,
        agent: document.getElementById('agent').value,
        adresa: document.getElementById('adresa').value,
        telefon: document.getElementById('telefon').value,
        slikano: document.getElementById('slikano').checked
      };

      fetch(URL, {
        method: "POST",
        body: JSON.stringify(podaci)
      }).then(() => {
        alert("Sačuvano!");
        ucitajTermine();
      });
    }

    function ucitajTermine() {
      fetch(URL)
        .then(res => res.json())
        .then(podaci => {
          const div = document.getElementById("listaTermina");
          if (podaci.length === 0) {
            div.innerHTML = "Nema unetih termina.";
            return;
          }
          div.innerHTML = podaci.map(red => `
            <div class="termin">
              <strong>${red[0]} ${red[1]}</strong><br/>
              Šifra: ${red[2]} | Agent: ${red[3]}<br/>
              Adresa: ${red[4]}<br/>
              Tel: ${red[5]}<br/>
              Slikano: ${red[6]}
            </div>
          `).join('');
        });
    }

    window.onload = ucitajTermine;
  </script>
</body>
</html>
